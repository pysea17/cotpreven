<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Cotizaci√≥n Revisi√≥n Preventiva</title>
    <style>
        :root{
            /* Ajusta aqu√≠ las alturas de cabecera y pie (evitan solapar contenido).
               Usa cm para impresi√≥n (ej: 3cm). */
            --header-height: 3.0cm;
            --footer-height: 3.5cm;
            /* Coloca URLs por defecto (reemplazables desde JS) */
            --top-image: none;
            --bottom-image: none;

            /* Ajustes de impresi√≥n para que los fondos se impriman tal como se ven */
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
            color-adjust: exact;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        /* Contenedor principal y secciones (igual que antes) */
        .container { max-width: 1200px; margin: 0 auto; display: grid; grid-template-columns: 1fr 1fr; gap: 30px; display: none; }
        .container.active { display: grid; }
        .form-section, .preview-section { background: white; border-radius: 15px; padding: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .header-bar { display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; }
        h2 { color:#667eea; margin:0; font-size:24px; }
        label, .form-group { margin-bottom: 8px; color:#333; font-weight:bold; font-size:14px; }
        input, select { width:100%; padding:12px; border:2px solid #e0e0e0; border-radius:8px; font-size:14px; }
        .btn-print { width:100%; padding:12px; background:#4CAF50; color:white; border:none; border-radius:8px; font-size:14px; font-weight:bold; cursor:pointer; margin-bottom:20px; }

        /* DOCUMENT - esta es la hoja tama√±o carta virtual */
        .document {
            /* tama√±o de visualizaci√≥n Aprox. carta (ancho real para impresi√≥n) */
            width: 21.59cm;
            min-height: 27.94cm;
            margin: 0 auto;
            position: relative;
            /* El contenido debe ir por encima de las im√°genes de membrete */
            background: white;
            border: 1px solid #ddd;
            padding: 1.8cm 2.5cm; /* padding lateral y un padding base; luego a√±adimos top/bottom para las imagenes */
            /* A√±adimos padding superior e inferior seg√∫n las variables para evitar solape */
            padding-top: calc(var(--header-height) + 1.5cm);   /* + espacio extra para separaci√≥n del contenido */
            padding-bottom: calc(var(--footer-height) + 1.5cm);
            overflow: hidden;
        }

        /* Usamos pseudo-elementos ::before (cabecera) y ::after (pie) para colocar las im√°genes.
           Est√°n detr√°s del contenido (.document-inner tiene z-index:1). */
        .document::before,
        .document::after {
            content: "";
            position: absolute;
            left: 0;
            width: 100%;
            background-repeat: no-repeat;
            background-position: center;
            background-size: 100% 100%; /* forzar a ajustar a la anchura y altura del espacio reservado */
            z-index: 0;
            pointer-events: none;
        }

        /* Cabecera (arriba) */
        .document::before {
            top: 0;
            height: var(--header-height);
            background-image: var(--top-image);
        }

        /* Pie (abajo) */
        .document::after {
            bottom: 0;
            height: var(--footer-height);
            background-image: var(--bottom-image);
        }

        /* Contenido sobre las im√°genes */
        .document-inner { position: relative; z-index: 1; }

        /* Resto del estilo del documento (igual que antes) */
        .document-header { text-align: left; margin-bottom: 25px; }
        .document-date { font-size: 12px; margin-bottom: 15px; }
        .document-recipient { margin-bottom: 15px; line-height: 1.5; font-size: 12px; }
        .document-ref { margin-bottom: 20px; font-weight: bold; font-size: 12px; }
        .document-content { text-align: justify; line-height: 1.6; font-size: 11px; }
        .document-content p { margin-bottom: 12px; }
        table { width:100%; border-collapse:collapse; margin:15px 0; font-size:11px; }
        table th, table td { border:1px solid #333; padding:8px; text-align:center; }
        table th { background:#f0f0f0; font-weight:bold; }
        .numbered-list { margin:15px 0; }
        .numbered-list p { margin-bottom:12px; text-indent:-25px; padding-left:25px; }
        .document-footer { margin-top:30px; font-size:11px; }
        .signature-line { margin-top:40px; border-top:1px solid #333; width:300px; padding-top:10px; font-size:11px; }

        /* Impresion */
        @media print {
            body { background:white; padding:0; }
            .container { grid-template-columns:1fr; }
            .form-section { display:none; }
            .preview-section { box-shadow:none; padding:0; }
            .btn-print { display:none; }
            .document { border:none; box-shadow:none; margin:0; /* Mantener padding que evita solapamiento */ }
            @page { size: letter; margin: 0; } /* poner a 0 porque la hoja .document contiene los m√°rgenes reales */
        }

        @media (max-width: 968px) { .container { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <!-- Pantalla de Login (id√©ntico al anterior; lo mantengo para contexto) -->
    <div class="login-container" id="loginScreen">
        <h2>üîê Acceso al Sistema</h2>
        <div class="error-message" id="errorMessage">Usuario o contrase√±a incorrectos</div>
        <form class="login-form" onsubmit="login(event)">
            <div class="form-group">
                <label>Usuario:</label>
                <input type="text" id="username" required>
            </div>
            <div class="form-group">
                <label>Contrase√±a:</label>
                <input type="password" id="password" required>
            </div>
            <button type="submit" class="btn-login">Ingresar</button>
        </form>
    </div>

    <div class="container" id="mainContainer">
        <div class="form-section">
            <div class="header-bar">
                <h2>üìã Datos de la Cotizaci√≥n</h2>
                <button class="btn-logout" onclick="logout()">Cerrar Sesi√≥n</button>
            </div>

            <div class="form-group">
                <label>Ciudad:</label>
                <input type="text" id="ciudad" placeholder="Ej: Barrancabermeja" value="Barrancabermeja">
            </div>

            <div class="form-group">
                <label>Nombre del Cliente:</label>
                <input type="text" id="cliente" placeholder="Ej: TRANSCOLTUR" value="TRANSCOLTUR">
            </div>

            <div class="form-group">
                <label>NIT o C√©dula:</label>
                <input type="text" id="nit" placeholder="Ej: 830.053.894-6" value="830.053.894-6">
            </div>

            <div class="form-group">
                <label>Placas del Veh√≠culo:</label>
                <input type="text" id="placas" placeholder="Ej: JTW104" value="JTW104">
            </div>

            <div class="form-group">
                <label>Modelo del Veh√≠culo:</label>
                <input type="text" id="modelo" placeholder="Ej: 2022" value="2022">
            </div>

            <div class="form-group">
                <label>Valor Total de la Cotizaci√≥n:</label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="valor50" name="valor" value="50000" checked>
                        <label for="valor50" style="margin: 0;">$50.000</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="valor60" name="valor" value="60000">
                        <label for="valor60" style="margin: 0;">$60.000</label>
                    </div>
                </div>
            </div>

            <button class="btn-generate" onclick="generarCotizacion()">Generar Cotizaci√≥n</button>
        </div>

        <div class="preview-section">
            <button class="btn-print" onclick="window.print()">üñ®Ô∏è Imprimir / Guardar PDF</button>

            <div class="document" id="documento">
                <div class="document-inner">
                    <div class="document-header">
                        <div class="document-date" id="fecha"></div>
                        <div class="document-recipient">
                            <strong>Se√±ores:</strong><br>
                            <span id="clienteDoc"></span><br>
                            NIT: <span id="nitDoc"></span><br>
                            <span id="ciudadDoc"></span>
                        </div>
                        <div class="document-ref">Ref.: Revisi√≥n Preventiva</div>
                    </div>

                    <div class="document-content">
                        <p>Atendiendo su amable solicitud, me permito presentar para su consideraci√≥n y an√°lisis, la propuesta para la realizaci√≥n del servicio Revisi√≥n Preventiva:</p>

                        <p><strong>‚Ä¢ Costos del servicio:</strong></p>

                        <table>
                            <thead>
                                <tr>
                                    <th>Descripci√≥n</th>
                                    <th>TARIFA</th>
                                    <th>IVA</th>
                                    <th>TOTAL</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="text-align: left;">Veh√≠culo Liviano P√∫blico Placas <span id="placasTabla"></span>, Modelo <span id="modeloTabla"></span></td>
                                    <td id="tarifa"></td>
                                    <td id="iva"></td>
                                    <td id="total"></td>
                                </tr>
                            </tbody>
                        </table>

                        <p>Dentro de esta cotizaci√≥n se debe tener en cuenta los siguientes aspectos:</p>

                        <div class="numbered-list">
                            <p><strong>1.</strong> La revisi√≥n preventiva es un servicio diferente a la Revisi√≥n T√©cnico Mec√°nica y de Emisiones Contaminantes y no est√° vinculado a la entrega de un certificado.</p>

                            <p><strong>2.</strong> La revisi√≥n preventiva entrega un informe con un concepto aprobado o rechazado, seg√∫n el cumplimiento de los √≠tems de inspecci√≥n de la NTC 5375:2012, evaluados sensorialmente y mediante pruebas mecanizadas. Esto incluye la medici√≥n de la profundidad de labrado de las llantas de servicio y de repuesto, verificaci√≥n de fugas de l√≠quidos, y revisi√≥n del estado general de la parte inferior del veh√≠culo de manera visual y al tacto, sin usar equipos especializados. Tambi√©n se comprueban los niveles de l√≠quidos en los dep√≥sitos (frenos, limpiaparabrisas, refrigerante) y se realizan pruebas de alineaci√≥n, suspensi√≥n, frenos, luces y emisiones contaminantes.</p>

                            <p><strong>3.</strong> La revisi√≥n preventiva no reemplaza el mantenimiento preventivo, como se indica en art√≠culo 3 de la resoluci√≥n 0315 de 2013 aclarado por el art√≠culo 1 de la resoluci√≥n 378 de 2013 "Art√≠culo 3.- Mantenimiento de veh√≠culos. El mantenimiento de los veh√≠culos ser√° preventivo y correctivo. El mantenimiento preventivo constituye la serie de intervenciones y reparaciones realizadas al veh√≠culo con la finalidad de anticipar fallas o desperfectos; no podr√° entenderse por mantenimiento preventivo las actividades de revisi√≥n o inspecci√≥n. El mantenimiento correctivo es aquel que se ejecuta en cualquier momento al veh√≠culo y ante la evidencia de una falla en cualquiera de sus componentes."</p>
                        </div>

                        <p>De optar por nuestros servicios por favor realizar transferencia a la cuenta corriente del Banco de Bogot√° No. 168604882 a nombre de INVERSIN LTDA.</p>

                        <p>Colocamos nuestras instalaciones a su servicio.</p>

                        <div class="document-footer">
                            <p>Cordialmente,</p>
                            <div class="signature-line">
                                <strong>MARIAM ANDREA RUEDA SUSPEZ</strong><br>
                                Gerente
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        // ===== CONFIGURACI√ìN =====
        const USUARIO_VALIDO = 'admin';
        const CONTRASENA_VALIDA = 'inversin2025';

        // Reemplaza estas URLs por las URLs "raw" de GitHub donde subir√°s las dos im√°genes
        // Ejemplo raw: https://raw.githubusercontent.com/TU_USUARIO/TU_REPO/main/header.jpg
        const TOP_IMAGE_RAW_URL = 'https://raw.githubusercontent.com/TU_USUARIO/TU_REPO/main/header.jpg';   // imagen superior (logo/membrete)
        const BOTTOM_IMAGE_RAW_URL = 'https://raw.githubusercontent.com/TU_USUARIO/TU_REPO/main/footer.jpg'; // imagen inferior (pie)

        // Ajusta las alturas si tus im√°genes son m√°s altas/peque√±as
        // (tambi√©n puedes cambiar las variables CSS en :root si prefieres)
        const HEADER_HEIGHT_CM = '3.0cm';
        const FOOTER_HEIGHT_CM = '3.5cm';
        // ===== FIN CONFIGURACI√ìN =====

        // Login/logout
        function login(event) {
            event.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const errorMessage = document.getElementById('errorMessage');

            if (username === USUARIO_VALIDO && password === CONTRASENA_VALIDA) {
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('mainContainer').classList.add('active');
                generarCotizacion();
            } else {
                errorMessage.style.display = 'block';
                setTimeout(() => { errorMessage.style.display = 'none'; }, 3000);
            }
        }

        function logout() {
            if (confirm('¬øEst√° seguro que desea cerrar sesi√≥n?')) {
                document.getElementById('loginScreen').style.display = 'block';
                document.getElementById('mainContainer').classList.remove('active');
                document.getElementById('username').value = '';
                document.getElementById('password').value = '';
            }
        }

        // Formatea n√∫meros a pesos
        function formatearPeso(valor) {
            return new Intl.NumberFormat('es-CO').format(valor);
        }

        // Aplicar las im√°genes (con variables CSS para usarlas en pseudo-elementos ::before/::after)
        function aplicarImagenesFondo(topUrl, bottomUrl, headerHeight, footerHeight) {
            // Usamos variables CSS con formato "url('...')" para background-image
            const root = document.documentElement;
            root.style.setProperty('--top-image', topUrl ? `url('${topUrl}')` : 'none');
            root.style.setProperty('--bottom-image', bottomUrl ? `url('${bottomUrl}')` : 'none');
            root.style.setProperty('--header-height', headerHeight || '3.0cm');
            root.style.setProperty('--footer-height', footerHeight || '3.5cm');
        }

        // Generar cotizaci√≥n y aplicar imagen de fondo
        function generarCotizacion() {
            const ciudad = document.getElementById('ciudad').value || 'Barrancabermeja';
            const cliente = document.getElementById('cliente').value || 'CLIENTE';
            const nit = document.getElementById('nit').value || '000.000.000-0';
            const placas = document.getElementById('placas').value || 'ABC123';
            const modelo = document.getElementById('modelo').value || '2022';
            const valorTotal = parseInt(document.querySelector('input[name="valor"]:checked').value);

            // Aplicar imagenes de cabecera y pie (reemplaza las constantes al principio con tus raw URLs)
            aplicarImagenesFondo(TOP_IMAGE_RAW_URL, BOTTOM_IMAGE_RAW_URL, HEADER_HEIGHT_CM, FOOTER_HEIGHT_CM);

            // Calcular tarifa e IVA
            const iva = Math.round(valorTotal * 0.19);
            const tarifa = valorTotal - iva;

            // Obtener fecha actual en formato deseado
            const fechaActual = new Date();
            const diasSemana = ['domingo', 'lunes', 'martes', 'mi√©rcoles', 'jueves', 'viernes', 's√°bado'];
            const meses = ['enero', 'febrero', 'marzo', 'abril', 'mayo', 'junio', 'julio', 'agosto', 'septiembre', 'octubre', 'noviembre', 'diciembre'];

            const diaSemana = diasSemana[fechaActual.getDay()];
            const dia = fechaActual.getDate();
            const mes = meses[fechaActual.getMonth()];
            const a√±o = fechaActual.getFullYear();
            const fechaTexto = `${ciudad}, ${diaSemana} ${dia} de ${mes} de ${a√±o}`;

            // Actualizar documento
            document.getElementById('fecha').textContent = fechaTexto;
            document.getElementById('clienteDoc').textContent = cliente;
            document.getElementById('nitDoc').textContent = nit;
            document.getElementById('ciudadDoc').textContent = ciudad;
            document.getElementById('placasTabla').textContent = placas;
            document.getElementById('modeloTabla').textContent = modelo;
            document.getElementById('tarifa').textContent = formatearPeso(tarifa);
            document.getElementById('iva').textContent = formatearPeso(iva);
            document.getElementById('total').textContent = formatearPeso(valorTotal);
        }

        // Ejecutar aplicar im√°genes inicialmente (por si abre sin generar)
        document.addEventListener('DOMContentLoaded', () => {
            aplicarImagenesFondo(TOP_IMAGE_RAW_URL, BOTTOM_IMAGE_RAW_URL, HEADER_HEIGHT_CM, FOOTER_HEIGHT_CM);
            generarCotizacion();
        });
    </script>
</body>
</html>
